---
–ò—Å—Ç–æ—á–Ω–∏–∫: https://www.bizkit.ru/2018/12/21/11181/
---

# –°–Ω—è—Ç–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å—á–µ—Ç—á–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã –Ω–∞ Arduino


–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —Å—á–µ—Ç—á–∏–∫–∞ ‚Äî —É–¥–æ–±–Ω–∞—è –æ–ø—Ü–∏—è, –æ–¥–Ω–∞–∫–æ, —Ä–µ—à–µ–Ω–∏—è –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π —Å—Ç–æ—è—Ç —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ. –°—Ä–æ–∫ –æ–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π. üôÇ –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ —Å–æ–±—Ä–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤–æ–¥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é –≤–º–µ—Å—Ç–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º, —Ç–æ —ç—Ç–æ —É–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ. üôÇ

–°—á–µ—Ç—á–∏–∫–∏ –≤–æ–¥—ã –æ–±—ã—á–Ω–æ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—Ç—Å—è –∏–º–ø—É–ª—å—Å–Ω—ã–º –≤—ã—Ö–æ–¥–æ–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–º —Å—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥ –≤–æ–¥—ã. –û–±—ã—á–Ω–æ –≤ —Ç–∞–∫–∏—Ö —Å—á–µ—Ç—á–∏–∫–∞—Ö —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≥–µ—Ä–∫–æ–Ω, —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π –∫–∞–∂–¥—ã–µ 10 –ª–∏—Ç—Ä–æ–≤. –ò –ø–æ—Å–ª–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –≥–µ—Ä–∫–æ–Ω –∑–∞–º–∫–Ω—É—Ç –≤ —Ç–µ—á–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ—Å—è—Ç–∫–æ–≤ —Å–µ–∫—É–Ω–¥. —Ç.–µ. –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π.

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π:

- –°–Ω—è—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã —Å –∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ —Å—á–µ—Ç—á–∏–∫–∞.
- –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å–Ω—è—Ç—ã—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π.
- –ü–µ—Ä–µ–¥–∞—á–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

## –°–Ω—è—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞

–ì–µ—Ä–∫–æ–Ω, –ø–æ —Å—É—Ç–∏ ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞, —É–ø—Ä–∞–≤–ª—è–µ–º–∞—è –º–∞–≥–Ω–∏—Ç–æ–º. –ü–æ—ç—Ç–æ–º—É –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞¬†[—Å—Ö–µ–º–∞ –∫–æ–º–º—É—Ç–∞—Ü–∏–∏ –¥–ª—è –æ–±—ã—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏](https://www.arduino.cc/en/Tutorial/InputPullupSerial). –≠—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ–µ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. –ë—ã—Ç–æ–≤–æ–π —Å—á–µ—Ç—á–∏–∫ –≤–æ–¥—ã –ø–æ—Å–ª–µ –∫–æ–º–º—É—Ç–∞—Ü–∏–∏ –≥–µ—Ä–∫–æ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ–∫—É–Ω–¥ ¬´–¥–µ—Ä–∂–∏—Ç¬ª –≥–µ—Ä–∫–æ–Ω –≤ –∑–∞–º–∫–Ω—É—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

![](https://i0.wp.com/www.bizkit.ru/wp-content/uploads/2018/12/inputPullupSerial_sch.png?fit=486%2C600)

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≥–µ—Ä–∫–æ–Ω–∞  
–∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ö–µ–º–∞—Ö –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏/–≥–µ—Ä–∫–æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π ¬´–ø–æ–¥–≤–µ—à–∏–≤–∞—é—â–∏–π¬ª —Ä–µ–∑–∏—Å—Ç–æ—Ä. –°–º—ã—Å–ª–∞ –≤ —ç—Ç–æ–º –Ω–µ—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —Å–∞–º–æ–º —á–∏–ø–µ –µ—Å—Ç—å —Ä–µ–∑–∏—Å—Ç—Ä —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Å +5V. –û–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∫–æ–¥–æ–º: pinMode(PULSE_PIN, INPUT_PULLUP).

–û–¥–Ω–∞–∫–æ –≥–µ—Ä–∫–æ–Ω –Ω—É–∂–Ω–æ¬†**–ø–æ–¥–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ —Ä–µ–∑–∏—Å—Ç–æ—Ä –Ω–∞ 1 –∫–û–º**¬†–∫ –≤—Ö–æ–¥—É GPIO. –û–Ω –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –Ω–µ ¬´—Å–ø–∞–ª–∏—Ç—å¬ª –ø–æ—Ä—Ç –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –µ—Å–ª–∏ –ø—Ä–æ—à–∏–≤–∫–∞ —Å–ª—É—á–∞–π–Ω–æ –≤—ã—Å—Ç–∞–≤–∏—Ç –µ–¥–∏–Ω–∏—Ü—É –Ω–∞ –ø–∏–Ω–µ, –∞ –≥–µ—Ä–∫–æ–Ω –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∑–∞–∫–æ—Ä–æ—Ç–∏—Ç —ç—Ç—É –ª–∏–Ω–∏—é –Ω–∞ –∑–µ–º–ª—é. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ—Ç–µ—á–µ—Ç —Ç–æ–∫ I = 3.3–í/1000 –û–º = 3.3 –º–ê –ø—Ä–∏ —Ç–æ–º, —á—Ç–æ —Ç–æ–∫ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å—Ç—Ä–æ—è GPIO ESP8266 ‚Äî 12 –º–ê, –∞ ESP32 ‚Äî 20 –º–ê.

–ü—Ä–∏ –∫–æ–º–º—É—Ç–∞—Ü–∏–∏ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –¥—Ä–µ–±–µ–∑–≥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –ª–æ–∂–Ω–æ–º—É —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—é –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏. –ö–∞–∫ —É—Å—Ç—Ä–∞–Ω—è—Ç—å –¥—Ä–µ–±–µ–∑–≥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–æ –≤¬†[—Å—Ç–∞—Ç—å–µ](https://www.bizkit.ru/2019/03/26/13145/).

–ü–æ—Å–∫–æ–ª—å–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–µ, –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –≤—Ä–æ–¥–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏–¥—Ç–∞ –∏–ª–∏ RC —Ü–µ–ø–æ—á–∫–∏, –¥–ª—è –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å—á–∏—Ç—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–µ—Ä–∫–æ–Ω–∞.¬†

¬†–ö–æ–¥ Arduino –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã:
```cpp
#include "Bounce2.h";

int LED_PIN = 13;
int PULSE_PIN = 2;
int water_counter = 0; 
bool last_PULSE_PIN_State = false;

// Initiate Debouncer 
Bounce debouncer = Bounce();

void setup() {
  // Initialize digital pin 2 as an input with the internal pull-up (+5V) resistor enabled
  pinMode(PULSE_PIN, INPUT_PULLUP);

  // Attach PULSE_PIN for debouncing
  debouncer.attach(PULSE_PIN);
  debouncer.interval(50); // Ignore interval
  
  pinMode(LED_PIN, OUTPUT);
  Serial.begin(9600, SERIAL_8N1);
}

void loop() {  
  debouncer.update();
 
  // Read Reed Switch state
  int value = debouncer.read();
 
  // Now all processes are finished and we know exactly the state of the Reed Switch
  if ( value == LOW ) {
    digitalWrite(LED_PIN, HIGH );
    if (last_PULSE_PIN_State == false)
    {
      water_counter++;
      Serial.println("Water consumption: " + (String)(water_counter*10) + " l.");
    }
    last_PULSE_PIN_State = true;
  }
  else {
    digitalWrite(LED_PIN, LOW);
    last_PULSE_PIN_State = false;
  }
}
```

–ö–æ–¥ –±—ã–ª –æ—Ç—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å—á–µ—Ç—á–∏–∫–µ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã Valtec VLF-U-I. –°—Ö–µ–º–∞ –∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞:

![](http://www.bizkit.ru/wp-content/uploads/2018/12/Valtec-VLF-U-I.png)

–°—Ö–µ–º–∞ –∏–º–ø—É–ª—å—Å–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞  
Valtec VLF-U-I

- PIN 2 Arduino –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ 1 –≤—ã—Ö–æ–¥—É –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞.
- GND Arduino –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ 4 –≤—ã—Ö–æ–¥—É –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞.
- –í —Å–ª—É—á–∞–µ —Å –≥–µ—Ä–∫–æ–Ω–æ–º –∫–æ–Ω—Ç–∞–∫—Ç—ã 1 –∏ 4 –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏. üôÇ

–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞ ‚Äî —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π.

```cpp
int LED_PIN = 13;
int PULSE_PIN = 2;
int water_counter = 0; 

long lastDebounce = 0;
long debounceDelay = 500;  // Ignore bounces less than 500 ms. Need to calibrate with water meter!!! A too large value will conduct missing increment. 

void setup() {
  Serial.begin(9600);
  pinMode(PULSE_PIN, INPUT_PULLUP); //Pullup internal resister
  pinMode(LED_PIN, OUTPUT);
  digitalWrite(PULSE_PIN, HIGH);
  attachInterrupt(digitalPinToInterrupt(PULSE_PIN), trigger, FALLING);
}

void loop() {
  int state = digitalRead(PULSE_PIN);
  digitalWrite(LED_PIN, !state );
}

void trigger() {
  if ((millis() - lastDebounce) > debounceDelay) 
  { 
    water_counter++;
    Serial.println("Water consumption: " + (String)(water_counter*10) + " l.");
    lastDebounce = millis();
  }
}
```

–ï—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∫–æ–¥–∞, —Ç–æ —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏ –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª–µ–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–º, –Ω–æ –∏ –±–æ–ª–µ–µ –∫–∞–ø—Ä–∏–∑–Ω—ã–º. –î–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ–º —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ RC —Ü–µ–ø–æ—á–∫–æ–π –∏–ª–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–º –®–º–∏—Ç—Ç–∞ (–®–º–∏–¥—Ç–∞).

–ü—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –Ω—É–∂–Ω–æ –æ—á–µ–Ω—å –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–æ–¥–±–∏—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è. –ï—Å–ª–∏ –µ–≥–æ –≤–∑—è—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º, —Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–∫–æ—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫ –≤ –ø–æ–¥—Å—á–µ—Ç–µ —Ä–∞—Å—Ö–æ–¥–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è. –ü–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å¬†[–∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞](https://www.bizkit.ru/2019/03/26/13145/)¬†—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π –∫–æ–¥–∞.

–í —Å–ª—É—á–∞–µ —Å –æ–ø—Ä–æ—Å–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ü–∏–∫–ª–µ, —á–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç ¬´–¥—Ä–µ–±–µ–∑–≥–∞¬ª –≤–∑—è—Ç—å (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–∑—É–º–Ω–æ–≥–æ), —Ç–µ–º –Ω–∞–¥–µ–∂–Ω–µ–µ –±—É–¥–µ—Ç –∏–∑–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –¥—Ä–µ–±–µ–∑–≥–∞ –∏ –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–ø—É—Å–∫–æ–º, –ø–æ—Å–∫–æ–ª—å–∫—É –∏–º–ø—É–ª—å—Å –æ—Ç –≥–µ—Ä–∫–æ–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–π, –¥–ª–∏—Ç—Å—è —Å–µ–∫—É–Ω–¥—ã ‚Äî —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –º–æ–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

## –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤–æ–¥—ã –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ. –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ —Å—Ç–∞—Ç–µ–π:

- [https://github.com/slacky1965/watermeter](https://github.com/slacky1965/watermeter)¬†‚Äî¬†[–ø—Ä–æ–µ–∫—Ç](http://www.mastergrad.com/forums/t233797-srochno-distancionnoe-snyatie-pokazaniy-s-treh-schetkov-vody-s-imp-vyhodom/?page=2#post6172838)¬†–Ω–∞ ESP8266.
- [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–Ω—è—Ç–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å–æ —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤–æ–¥—ã](https://blog.instalator.ru/archives/194).
- [–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∏–º–ø—É–ª—å—Å —Å –¥–∞—Ç—á–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–∞ –≤–æ–¥—ã](http://arduino.ru/forum/obshchii/kak-poluchit-impuls-s-datchika-raskhoda-vody?page=1#comment-81046).
- [–ü–æ–¥–∫–ª—é—á–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤–æ–¥—ã –∫ —É–º–Ω–æ–º—É –¥–æ–º—É](https://habr.com/ru/post/411259/).
- [–°—á–µ—Ç—á–∏–∫ –≤–æ–¥—ã –∏–º–ø—É–ª—å—Å–Ω—ã–π –¥–∞—Ç—á–∏–∫](http://mysensors.ru/build/pulse_water/).
- [Smart meter pulse counter](https://github.com/xoseperez/pulsecounter). –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ¬†[–ø—Ä–æ–µ–∫—Ç–∞](http://tinkerman.eldiariblau.net/smartmeter-pulse-counter-4/). –°—á–∏—Ç—ã–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ XBee.
- [Power meter pulse sensor](https://www.mysensors.org/build/pulse_power). (—Å–Ω—è—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞ –Ω–∞ —Å—á–µ—Ç—á–∏–∫–µ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏).
- [Water meter pulse sensor](https://www.mysensors.org/build/pulse_water). (—Å–Ω—è—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –±–∞—Ä—å–µ—Ä–Ω—ã–º –¥–∞—Ç—á–∏–∫–æ–º).


# –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –≤ —Å—á–µ—Ç—á–∏–∫–µ –≤–æ–¥—ã

–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ¬†[26.03.2019](https://www.bizkit.ru/2019/03/26/13145/ "11:48 –¥–ø")¬†–∞–≤—Ç–æ—Ä–æ–º¬†[Andrey Fedorov](https://www.bizkit.ru/author/admin/ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∞–≤—Ç–æ—Ä–∞ Andrey Fedorov")

–í¬†[–ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç–∞—Ç—å–µ](https://www.bizkit.ru/2018/12/21/11181/)¬†—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª –ø—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –¥–ª—è —Å–Ω—è—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å—á–µ—Ç—á–∏–∫–∞ –≤–æ–¥—ã. –í –Ω–µ–π –¥–ª—è –∏–∑–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π —Å–ø–æ—Å–æ–± —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏¬†[bouncer2](https://github.com/thomasfredericks/Bounce2).

## –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

–ò–∑–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ö–æ—Ä–æ—à–æ –æ–ø–∏—Å–∞–Ω–æ –≤ —Å—Ç–∞—Ç—å–µ ¬´[–î—Ä–µ–±–µ–∑–≥: –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ](http://codius.ru/articles/Arduino_%D0%94%D1%80%D0%B5%D0%B1%D0%B5%D0%B7%D0%B3_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%B8_%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D1%83%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5)¬´. –í –ø—Ä–æ—Å—Ç–µ–π—à–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∫ –≤—Ö–æ–¥—É –≥–µ—Ä–∫–æ–Ω—É –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞, –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ—Ä—è–¥–∫–∞ 20 –º—Å –ø–æ–∫–∞ –∑–∞–∫–æ–Ω—á–∞—Ç—å—Å—è –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞. –ï—Å–ª–∏ –≤—Ö–æ–¥ –ø–æ –ø—Ä–æ—à–µ—Å—Ç–≤–∏–∏ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –≤ —Ç–æ–º-–∂–µ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, —Ç–æ –∑–Ω–∞—á–∏—Ç –≥–µ—Ä–∫–æ–Ω —Å—Ä–∞–±–æ—Ç–∞–ª.

–ö–æ–¥ –≤ —Å—Ç–∞—Ç—å–µ –ø–ª–æ—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º delay. –û–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –¥–ª—è ESP8266/ESP32/Arduino –ª—É—á—à–µ –≤–æ–æ–±—â–µ –∑–∞–±—ã—Ç—å, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π –¥—Ä—É–≥–∏–º –±–ª–æ–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–º—Å—è –∫ –∫–æ–¥—É debouncer. –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å millis() –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤—Ä–æ–¥–µ¬†[bouncer2](https://github.com/thomasfredericks/Bounce2).

–í–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è millis(). –í –Ω–µ–º —è –Ω–µ —Å—Ç–∞–ª –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫ –≤—ã—Ö–æ–¥—É –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ —Å–≤–µ—Ç–æ–¥–∏–æ–¥ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–µ—Ä–∫–æ–Ω–∞. –õ–∏—à—å —Å–¥–µ–ª–∞–ª –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ LED –≤ Serial.
```cpp
int pinButton = 14; //D5 - –ü–∏–Ω –∫–Ω–æ–ø–∫–∏
bool flag       = HIGH; //–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–µ–∫—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞
bool lastButton = LOW;
unsigned long currentMillis = 0;
unsigned long previousMillis = 0;
int debounceInterval = 20; //20 ms

void setup() 
{
  pinMode(pinButton, INPUT_PULLUP);
  Serial.begin(9600, SERIAL_8N1);
}

void loop() {
  bool currentButton = digitalRead(pinButton);
  currentMillis = millis();
  
  if (currentButton != lastButton)
  {
    previousMillis = currentMillis; //–°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∏–º–ø—É–ª—å—Å–∞ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –≥–µ—Ä–∫–æ–Ω–∞
    lastButton = currentButton;
  }
  else
  { 
    if (currentMillis - previousMillis > debounceInterval)  //–ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∑–∞ debounceInterval
    { 
      if (flag != currentButton) //–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏, –º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ LED
      {
        String state = currentButton ? "OFF" : "ON"; 
        Serial.println("Button is " + state); 
        flag = currentButton;
        lastButton = currentButton;  
      }
    }
  }
}
```

–û—Ç–º–µ—á—É, —á—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∫–æ–¥ –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å—Ç–æ–ª—å –ø—Ä–æ—Å—Ç –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ. –ì–µ—Ä–∫–æ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∑–∞–º–∫–Ω—É—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ï—Å–ª–∏ –±—ã –≤—Ä–µ–º—è –±—ã–ª–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ, –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, —á—Ç–æ–±—ã –Ω–µ —Å–ø—É—Ç–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–µ—Ä–∫–æ–Ω–∞.

## –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞

–î–ª—è —É–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RC —Ü–µ–ø–æ—á–∫—É, –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤ –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ö–µ–º—ã –∏–∑¬†[—Å—Ç–∞—Ç—å–∏](http://codius.ru/articles/Arduino_%D0%94%D1%80%D0%B5%D0%B1%D0%B5%D0%B7%D0%B3_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%B8_%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D1%83%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5).

![–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ (Arduino/ESP8266/EPS32)](http://www.bizkit.ru/wp-content/uploads/2019/03/WaterCounterDebouncer-1.png)

–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ (Arduino/ESP8266/EPS32)

[![](http://www.bizkit.ru/wp-content/uploads/2019/03/WaterCounterDebouncerImitation-1.png)](http://tinyurl.com/y322t553)

–ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

–ü–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å —Ä–∞–±–æ—Ç–æ–π —Å—Ö–µ–º—ã –º–æ–∂–Ω–æ¬†[–∑–¥–µ—Å—å](http://tinyurl.com/y322t553). –ü—Ä–∏ —Ä–∞–∑–æ–º–∫–Ω—É—Ç–æ–π –∫–Ω–æ–ø–∫–µ –µ–º–∫–æ—Å—Ç—å C1 –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ R1. –ù–∞ –≤—Ö–æ–¥–µ –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É—â–µ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏—Ç—Ç–∞ +VCC. –ù–∞ –≤—ã—Ö–æ–¥–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ 0.

–ó–¥–µ—Å—å RC —Ü–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏ —Ä–∞–∑–º—ã–∫–∞–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏. –ü—Ä–∏ –∑–∞–º—ã–∫–∞–Ω–∏–∏ –µ–º–∫–æ—Å—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è, –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ä–∞–∑—Ä—è–∂–∞—è—Å—å –¥–æ –Ω—É–ª—è. –ü—Ä–∏ —ç—Ç–æ–º —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∫–Ω–æ–ø–∫–∏/–≥–µ—Ä–∫–æ–Ω–∞ –ø–æ –∑–∞–∫–æ–Ω—É –û–º–∞ I=U/R, –ø—Ä–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–∏ —Ä–∞–≤–Ω–æ–º 0, –±—É–¥–µ—Ç –ø—Ä–æ—Ç–µ–∫–∞—Ç—å –±–µ–∫–æ–Ω–µ—á–Ω—ã–π —Ç–æ–∫. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–∞–∑—Ä—è–∂–∞—Ç—å –µ–º–∫–æ—Å—Ç—å. –ü—Ä–∞–≤–∏–ª—å–Ω–µ–µ –≤—Å–µ-–∂–µ —Ä–∞–∑—Ä—è–∂–∞—Ç—å –µ—ë —á–µ—Ä–µ–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Ç–æ–∫ —Ä–∞–∑—Ä—è–¥–∞. –ü–æ—ç—Ç–æ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ —Å—Ö–µ–º–∞ –∏–∑¬†[—Å—Ç–∞—Ç—å–∏](http://robotosha.ru/arduino/connect-button-arduino.html).

![–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ (Arduino/ESP8266/EPS32)](http://www.bizkit.ru/wp-content/uploads/2019/03/WaterCounterDebouncer_1-1.png)

  
–ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ (Arduino/ESP8266/EPS32)

[![](http://www.bizkit.ru/wp-content/uploads/2019/03/WaterCounterDebouncerImitation_1.png)](http://tinyurl.com/y5pvl4ah)

–ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

–°—Ö–µ–º–∞ –ø–æ—á—Ç–∏ —Ç–∞–∫–∞—è-–∂–µ, –Ω–æ –ø—Ä–∏ –∑–∞–º—ã–∫–∞–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ –µ–º–∫–æ—Å—Ç—å –°2 —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è –Ω–∞ –∑–µ–º–ª—é —á–µ—Ä–µ–∑ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ R4, –ø–æ—ç—Ç–æ–º—É —Ç–æ–∫ –ø—Ä–æ—Ç–µ–∫–∞—é—â–∏–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–∞–∫—Ç—ã —É–∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–π –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤: I = U/R = 5/1000 = 5 –º–ê.

![](https://quicklatex.com/cache3/1f/ql_8860991a5244bd4f719650767a516d1f_l3.png)

t ‚Äî –≤—Ä–µ–º—è —Ä–∞–∑—Ä—è–¥–∞ —Å —É—Ä–æ–≤–Ω—è Vdc –¥–æ Vc. Vc ‚Äî –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —É—Ä–æ–≤–µ–Ω—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –∫–∞–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏–π –Ω–æ–ª—å. –Ø –≤–∑—è–ª Vc = 0,5 V. –í —Å—Ç–∞—Ç—å–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω—ã¬†[—É—Ä–æ–≤–Ω–∏ –¥–ª—è ESP8266.](http://henrysbench.capnfatz.com/henrys-bench/arduino-projects-tips-and-more/esp8266ex-gpio-high-and-low-input-thresholds/)¬†–Ø –≤–∑—è–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –≤–º–µ—Å—Ç–æ 0,8 V –¥–ª—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è, –Ω–∏–∂–µ –∫–æ—Ç–æ—Ä–æ–≥–æ ESP8266 —Å—á–∏—Ç–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—á–µ—Å–∫–∏–º –Ω—É–ª–µ–º.

t=-R2*C1*Ln(V0/Vdc) = 1000*10^-5*Ln(0.5/3.3) = 18,8 –º—Å

–ï—Å–ª–∏ –µ–º–∫–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏—Ç—å —Å 0,01 –º–∫–§ –¥–æ 0,1 –º–∫–§, —Ç–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä—è–¥–∫–∏ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–∞ C1 –¥–æ —É—Ä–æ–≤–Ω—è V0 –±—É–¥–µ—Ç —É–∂–µ 180 –º—Å, —á—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ. –û–¥–Ω–∞–∫–æ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞—Å—Ç–æ–ª—å–∫–æ –º–µ–¥–ª–µ–Ω–Ω—ã–µ, —á—Ç–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏ —Ç–∞–∫—É—é –µ–º–∫–æ—Å—Ç—å. –ï—ë —É–≤–µ–ª–∏—á–µ–Ω–∏–µ, –∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∏–Ω–µ—Ä—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏, –ª—É—á—à–µ —Å–≥–ª–∞–∂–∏–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –≤—Å–ø–ª–µ—Å–∫–∏, —É–º–µ–Ω—å—à–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

–†–µ–∑–∏—Å—Ç–æ—Ä R2 —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º –∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤—Ö–æ–¥–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –æ–Ω –≤—ã—Å—Ç–∞–≤–∏—Ç —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—á–µ—Å–∫–æ–π 1 –Ω–∞ –≤—Ö–æ–¥–µ –ø—Ä–∏ –∑–∞–º–∫–Ω—É—Ç–æ–π –Ω–∞ –∑–µ–º–ª—é –∫–Ω–æ–ø–∫–µ. –ë–µ–∑ —ç—Ç–æ–≥–æ —Ä–µ–∑–∏—Å—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ –≤—Ö–æ–¥ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –Ω–∞—á–∞–ª –±—ã –ø—Ä–æ—Ç–µ–∫–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–ª –±—ã –∏–∑ —Å—Ç—Ä–æ—è –≤—Ö–æ–¥.

## ESP8266 –∏ –¥—Ä–µ–±–µ–∑–≥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

–î–ª—è —Å–±–æ—Ä–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏—Ç—Ç–∞ –Ω–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (—Å—Å—ã–ª–∫–∏ –Ω–∞ Aliexpress):

- [Wemos D1 mini](http://ali.pub/2zl5st).
- [Wemos D1 mini RTC s](http://ali.pub/38754u)hield.¬†**–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏–µ —á–∏–ø–∞ 5V, –ø–æ—ç—Ç–æ–º—É shield –Ω–µ –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è –ø–∏—Ç–∞–Ω–∏—è –æ—Ç –±–∞—Ç–∞—Ä–µ–∏ 3,7 V.**
- [Wemos breadboard](http://ali.pub/3875z6).
- [–¢—Ä–∏–≥–≥–µ—Ä –®–º–∏—Ç—Ç–∞ SN74HC14N.](http://ali.pub/3876yk)¬†[Datasheet](http://www.ti.com/lit/ds/symlink/sn74hc14.pdf).
- –†–µ–∑–∏—Å—Ç–æ—Ä—ã 1 –∫–û–º ‚Äî 2 —à—Ç.
- –†–µ–∑–∏—Å—Ç–æ—Ä—ã 10 –∫–û–º ‚Äî 2 —à—Ç.
- –ö–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä—ã –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∏–µ 100 nF (0,1 mkF) ‚Äî 2 —à—Ç.
- [–ë–∞—Ç–∞—Ä–µ—è 18650](http://ali.pub/31437w).
- [–ö–µ–π—Å –¥–ª—è –±–∞—Ç–∞—Ä–µ–∏ 18650](http://ali.pub/3143f3).

Wemos D1 mini RT –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è¬†**RTC**:

|   |   |   |
|---|---|---|
|**Wemos D1 mini**  <br>**(ESP8266)**|**–û–ø–∏—Å–∞–Ω–∏–µ**|**[ESP32](https://randomnerdtutorials.com/esp32-pinout-reference-gpios/)**|
|D1 (GPIO5)|SCL|GPIO 22 (SCL)|
|D2 (GPIO4)|SDA|GPIO 21 (SDA)|
|5V||5V|
|GND||GND|

**SD card reader**¬†–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã:

|   |   |   |   |
|---|---|---|---|
|**Wemos D1 mini**  <br>**(ESP8266)**|**–û–ø–∏—Å–∞–Ω–∏–µ**|**[ESP32](https://randomnerdtutorials.com/esp32-pinout-reference-gpios/)**  <br>**VSPI**|**ESP32  <br>HSPI**|
|D5 (GPIO 14)|CLK/SCK|GPIO18|GPIO14|
|D6 (GPIO 12)|DO/MISO|GPIO19|GPIO12|
|D7 (GPIO13)|DI/MOSI|GPIO23|GPIO13|
|D8 (GPIO 15)|CS/SS|GPIO5|GPIO15|

–°–≤–æ–±–æ–¥–Ω—ã–º–∏ –æ—Å—Ç–∞–ª–æ—Å—å –Ω–µ–º–Ω–æ–≥–æ: D0 (GPIO16), D3 (GPIO0), D4 (GPIO3). –ò —ç—Ç–æ –≤—Å–µ¬†[–ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –≤—Ö–æ–¥—ã](https://wiki.wemos.cc/products:d1:d1):

- –í—Ö–æ–¥ D0 Wemos D1 mini –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç.
- D3, D4 ‚Äî –≤—Ö–æ–¥—ã –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ/–∑–∞–≥—Ä—É–∑–∫–µ ESP8266 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Å–∏–≥–Ω–∞–ª–∞. –ï—Å–ª–∏ –æ–Ω –±—É–¥–µ—Ç –¥—Ä—É–≥–∏–º, —Ç–æ –º–∏–∫—Ä–æ–ø—Ä–æ–≥—Ä–∞–º–º–∞ ESP8266 –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è. –¢.–µ., –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∞—Ç—å –≤—ã–≤–æ–¥—ã.
- –ö D4 –Ω–∞ Wemos D1 mini –ø–æ–¥—Å–æ–µ–¥–∏–Ω–µ–Ω LED.

–í –æ–±—â–µ–º, –ø–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å RTC —Å –∫–∞—Ä—Ç- —Ä–∏–¥–µ—Ä–æ–º –∏ –º–æ–¥—É–ª—å —Å —Ç—Ä–∏–≥–≥–µ—Ä–æ–º –®–º–∏—Ç—Ç–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è. –õ–∏–±–æ –ø—Ä–∏–¥–µ—Ç—Å—è –≤ —Å—Ö–µ–º—É –¥–æ–±–∞–≤–ª—è—Ç—å —á–∏–ø, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π¬†[—Ä–∞—Å—à–∏—Ä–∏—Ç—å –∫–æ–ª-–≤–æ –≤—Ö–æ–¥–æ–≤](https://www.bizkit.ru/2019/01/14/11464/). –í–ø—Ä–æ—á–µ–º, –æ—Å–æ–±–æ–≥–æ —Å–º—ã—Å–ª–∞ –≤ RTC –∏ –∫–∞—Ä—Ç-—Ä–∏–¥–µ—Ä–µ –Ω–µ—Ç, –µ—Å–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è¬†[–ø—Ä–∏–º–µ—Ä–æ–º –∫–æ–¥–∞](https://www.bizkit.ru/2019/01/21/11788/)¬†–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å NTP —Å–µ—Ä–≤–µ—Ä–æ–≤.

[![–í—ã–≤–æ–¥—ã —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏—Ç—Ç–∞ SN74HC14](https://i0.wp.com/www.bizkit.ru/wp-content/uploads/2019/03/SN74HC14_Shmitt_Trigger_pinouts.png?fit=640%2C592)](http://www.bizkit.ru/wp-content/uploads/2019/03/SN74HC14_Shmitt_Trigger_pinouts.png)

–í—ã–≤–æ–¥—ã —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏—Ç—Ç–∞ SN74HC14

## –ó–∞—á–µ–º –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞?

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –µ–º—É –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Ö–æ–¥–æ–≤. –≠—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–∞—Å—Ö–æ–¥—É–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—é.

–í—Å–µ –±—ã –Ω–∏—á–µ–≥–æ, –∫–æ–≥–¥–∞ –ø–∏—Ç–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç —ç–ª–µ–∫—Ç—Ä–æ—Å–µ—Ç–∏. –ù–æ, –ø–æ–¥–≤–æ–¥–∏—Ç—å –∫ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫—É 3,3/5 V –æ—Ç –±–ª–æ–∫–∞ –ø–∏—Ç–∞–Ω–∏—è –Ω–µ –≤—Å–µ–≥–¥–∞ —É–¥–æ–±–Ω–æ. –ù–µ—Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞—Ç–∞—Ä–µ—è –≤—Ä–æ–¥–µ¬†[18650](http://ali.pub/31437w), –∞ –µ–º–∫–æ—Å—Ç—å –µ—ë –Ω–µ –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω–∞. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ–¥–∑–∞—Ä—è–∂–∞—Ç—å –±–∞—Ç–∞—Ä–µ—é ‚Äî —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –Ω–µ –∏–∑ –ø—Ä–∏—è—Ç–Ω—ã—Ö. –ü–æ—ç—Ç–æ–º—É —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è ‚Äî –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø–æ–¥–æ–±–Ω—ã—Ö IoT —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

–í ESP8266 –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ ¬´—Å–ø—è—á–∫–∏¬ª, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –º–µ–Ω—å—à–µ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏, –∂–∏–≤—è –¥–æ–ª—å—à–µ –Ω–∞ –±–∞—Ç–∞—Ä–µ–µ.

[![–†–µ–∂–∏–º—ã —Å–ø—è—á–∫–∏ ESP8266](http://www.bizkit.ru/wp-content/uploads/2019/03/ESP8266_sleep_mode.png)](https://www.espressif.com/sites/default/files/9b-esp8266-low_power_solutions_en_0.pdf)

–†–µ–∂–∏–º—ã —Å–ø—è—á–∫–∏ ESP8266

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ ESP8266/ESP32:

- –í–º–µ—Å—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Ö–æ–¥–æ–≤ –≤ —Ü–∏–∫–ª–µ loop –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å—Ö–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ —ç—Ç–æ—Ç —Å–ø–æ—Å–æ–± –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –æ–ø–∏—Å–∞–Ω –≤¬†[—Å—Ç–∞—Ç—å–µ](https://www.bizkit.ru/2018/12/21/11181/).
- –ó–∞–≥–æ–Ω—è—Ç—å ESP8266/ESP32 –≤ deep-sleep —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Å—ã–ø–∞—Ç—å—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Ö–æ–¥–æ–≤. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –Ω–µ –Ω—É–∂–Ω–æ. –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–ø—è—á–∫–∏ ESP8266 –º–æ–≥ —É–∂–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –≥–µ—Ä–∫–æ–Ω–∞, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –æ–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Ö–æ–¥–æ–≤, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ–ø—è—Ç—å —É–π—Ç–∏ –≤ —Å–ø—è—á–∫—É. –í—Ä–µ–º—è —Å–ø—è—á–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –≥–µ—Ä–∫–æ–Ω–∞. –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—Å—è, —á—Ç–æ –ø–æ—Å–ª–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –≥–µ—Ä–∫–æ–Ω–∞, –µ—Å–ª–∏ —Å—Ä–∞–∑—É –≤—ã–∫–ª—é—á–∏—Ç—å –≤–æ–¥—É, –æ–Ω –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ –∑–∞–º–∫–Ω—É—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. –ï—Å–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—Å—è, —Ç–æ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –≤—Ä–µ–º—è deep sleep —Å —É—á–µ—Ç–æ–º —Ç–∞–∫–æ–≥–æ ¬´—Ñ–æ—Ä—Å-–º–∞–∂–æ—Ä–∞¬ª.
- –ó–∞–≥–æ–Ω—è—Ç—å ESP8266/ESP32 –≤ deep-sleep –∏ –≤—ã–≤–æ–¥–∏—Ç—å –µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–Ω—è–≤ –¥–∞–Ω–Ω—ã–µ —Å –≥–µ—Ä–∫–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ —Å—Ö–µ–º—É —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –ø–æ–¥–∞–≤ –∏–º–ø—É–ª—å—Å –Ω–∞ –≤—Ö–æ–¥ EXT_RSTB. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ç—Ä–∏–≥–≥–µ—Ä–∞ –®–º–∏—Ç—Ç–∞. –°—Ö–µ–º–æ—Ç–µ—Ö–Ω–∏–∫—É –¥–ª—è —Ç–∞–∫–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ–ø–∏—à—É –≤ –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç—å–µ.
- –£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ ESP8266/ESP32 —Å—Ç–∞—Ä—Ç—É—é—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –∑–∞–≤—è–∑–∞—Ç—å —Ü–µ–ø—å –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –≥–µ—Ä–∫–æ–Ω. –¢.–µ. –≤–∫–ª—é—á–∞—Ç—å —Å—Ö–µ–º—É, –ø—Ä–∏ –∑–∞–º—ã–∫–∞–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ –≥–µ—Ä–∫–æ–Ω–æ–≤.

## –°—Ö–µ–º–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ ESP8266 (Wemos D1 mini)

–°—Ö–µ–º–∞ –∏ –ø—Ä–∏–º–µ—Ä –ø–µ—á–∞—Ç–Ω–æ–π –ø–ª–∞—Ç—ã¬†[–≤ –ø—Ä–æ–µ–∫—Ç–µ EasyEDA](https://easyeda.com/fedorov/test). –û—Å—Ç–∞–≤–∏–ª I2C –≤—Ö–æ–¥—ã –Ω–µ–∑–∞–Ω—è—Ç—ã–º–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è¬†[–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞](https://www.bizkit.ru/2018/12/22/11241/).

[![](https://i0.wp.com/www.bizkit.ru/wp-content/uploads/2019/04/WaterMeter_Wemos_D1_Mini_Schematic.png?fit=610%2C600)](http://www.bizkit.ru/wp-content/uploads/2019/04/WaterMeter_Wemos_D1_Mini_Schematic.png)

–°—Ö–µ–º–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ Wemos D1 mini (ESP8266) —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä–µ –®–º–∏—Ç—Ç–∞

–°—Ö–µ–º—É —Å–¥–µ–ª–∞–ª –Ω–∞¬†[Wemos breadboard.](http://ali.pub/3875z6)

[![–ú–æ–Ω—Ç–∞–∂–Ω–∞—è –ø–ª–∞—Ç–∞ shield –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ Wemos D1 mini (ESP8266) —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä–µ –®–º–∏—Ç—Ç–∞](https://i2.wp.com/www.bizkit.ru/wp-content/uploads/2019/04/IMG_20190331_231622.jpg?fit=640%2C470)](https://easyeda.com/fedorov/test)

–ú–æ–Ω—Ç–∞–∂–Ω–∞—è –ø–ª–∞—Ç–∞ shield –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ Wemos D1 mini (ESP8266) —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä–µ –®–º–∏—Ç—Ç–∞

–ü—Ä–∏–º–µ—Ä –ø–µ—á–∞—Ç–Ω–æ–π –ø–ª–∞—Ç—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≤—Ç–æ—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–æ–π –≤ EasyEDA.

[![–ü–µ—á–∞—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ shield –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ Wemos D1 mini (ESP8266) —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä–µ –®–º–∏—Ç—Ç–∞](http://www.bizkit.ru/wp-content/uploads/2019/04/WaterMeter_Wemos_D1_Mini_PCB.png)](https://easyeda.com/fedorov/test)

  
–ü–µ—á–∞—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ shield –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞ Wemos D1 mini (ESP8266) —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –¥—Ä–µ–±–µ–∑–≥–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä–µ –®–º–∏—Ç—Ç–∞

## –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–æ–¥–æ—Å—á–µ—Ç—á–∏–∫–∞ –¥–ª—è ESP8266
```cpp
//int LED_PIN = 2; //D4
int COLD_WATER_PULSE_PIN = 12; //D6
int HOT_WATER_PULSE_PIN  = 13; //D7 4; //D2
int cold_water_counter = 0; 
int hot_water_counter = 0; 

void setup() 
{
  Serial.begin(9600);
  pinMode(COLD_WATER_PULSE_PIN, INPUT); //Pullup internal resister
  pinMode(HOT_WATER_PULSE_PIN,  INPUT); //Pullup internal resister
  //pinMode(LED_PIN, OUTPUT);
  attachInterrupt(digitalPinToInterrupt(COLD_WATER_PULSE_PIN), triggerColdWater, RISING);
  attachInterrupt(digitalPinToInterrupt(HOT_WATER_PULSE_PIN), triggerHotWater, RISING);
}

void loop() {
  //int state = digitalRead(HOT_WATER_PULSE_PIN);
  //Serial.println("State: " + (String)(state));
  //delay(1000);
  //digitalWrite(LED_PIN, !state );
}

void triggerColdWater() 
{
  cold_water_counter++;
  Serial.println("Cold water consumption: " + (String)(cold_water_counter*10) + " l.");
}

void triggerHotWater() 
{
  hot_water_counter++;
  Serial.println("Hot water consumption: " + (String)(hot_water_counter*10) + " l.");
}
```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [EMBED WITH ELLIOT: DEBOUNCE YOUR NOISY BUTTONS, PART II](https://hackaday.com/2015/12/10/embed-with-elliot-debounce-your-noisy-buttons-part-ii/)
- [Arduino: –î—Ä–µ–±–µ–∑–≥¬†‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ](http://codius.ru/articles/Arduino_%D0%94%D1%80%D0%B5%D0%B1%D0%B5%D0%B7%D0%B3_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%B8_%D0%B0%D0%BF%D0%BF%D0%B0%D1%80%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D1%83%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5)
- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∫ Arduino](http://robotosha.ru/arduino/connect-button-arduino.html)
- [ESP8266EX GPIO High and Low Input Thresholds](http://henrysbench.capnfatz.com/henrys-bench/arduino-projects-tips-and-more/esp8266ex-gpio-high-and-low-input-thresholds/)
- [Datasheet —Ç—Ä–∏–≥–≥–µ—Ä –®–º–∏—Ç—Ç–∞](http://www.ti.com/lit/ds/symlink/sn74hc14.pdf).
- [ESP8266 Low Power Solution (ENG)](https://www.espressif.com/sites/default/files/9b-esp8266-low_power_solutions_en_0.pdf). –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.
- [–í—ã–≤–æ–¥ ESP8266 –∏–∑ —Å–ø—è—á–∫–∏](https://github.com/esp8266/Arduino/issues/1488)¬†(ENG).
- [https://stackoverflow.com/questions/39481196/how-to-wake-esp8266-from-deep-sleep-without-continuous-resets](https://stackoverflow.com/questions/39481196/how-to-wake-esp8266-from-deep-sleep-without-continuous-resets)

Spread the love